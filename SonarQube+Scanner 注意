1.概论：SonarQube是管理代码质量一个开放平台，可以快速的定位代码中潜在的或者明显的错误，下面将会介绍一下这个工具的安装、配置以及使用。

2.说明： sonarqube8.0不支持mysql，如果需要用到mysql的朋友建议使用8.0以下版本，mysql版本只支持5.6以上。（如果版本不对请参照之前的mysql升级备份问题）

3.下载sonarqube7.0

  a、最新版官网地址：https://www.sonarqube.org/downloads/
  b、百度云盘：https://pan.baidu.com/s/1qCTXAHhFvuurpwibHIG8eQ 提取码：xkyr

4、下载sonar-scanner

  a、最新版官网地址：https://docs.sonarqube.org/latest/analysis/scan/sonarscanner/
 
5.安装
  1).安装sonarqube，在任意目录下解压sonarqube-7.0.zip
  2).进入conf目录的 sonar.properties 修改相应配置，这里我使用的是mysql5.7，
      在启动前需要新建 sonar 数据库，否则会启动失败，因为在启动的时候会默认去创建所需的表结构
      
    #此次的账号密码根据自己的数据库来设定，
    sonar.jdbc.username=root
    sonar.jdbc.password=root
    
    sonar.jdbc.url=jdbc:mysql://localhost:3306/sonar?useUnicode=true&characterEncoding=utf8&rewriteBatchedStatements=true&useConfigs=maxPerformance&useSSL=false
    
    #配置web端口
    sonar.web.port=9000
    
![](https://github.com/Huangqianqan/java-/blob/master/photo/sonarqube/01.png)

3）、确保jdk的环境变量已经配置完成，否则需要到wrapper.conf文件中指定启动的配置

4）、配置修改完成后，到bin目录下启动服务，此处我选择的是：sonarqube-7.0\bin\windows-x86-64

第一次启动有点慢，会去插入表
5）、出现以下画面说明启动成功

6）、等数据库表都创建成功就可以正常访问了

7）、在浏览器输入 http://localhost:9000进行访问，用户名密码都是admin。
第一次登录会看到 Tutorial，按照提示设置用于验证身份的token。生成的 token需要复制记下来！不会再显示第二次！ 在 用户 > 我的账户 > 安全 中可以生成新token（令牌），或者回收已创建的 token。

如果想强化安全，不想在执行代码扫描或调用Web Service时使用真实SonarQube用户的密码，可以使用用户令牌来代替用户登录。这样可以通过避免把分析用户的密码在网络传输，从而提升安全性。
2、安装scanner

1）、将下载好的文件 sonar-scanner-cli-4.2.0.1873-windows.zip解压到任意目录。
2）、配置windows系统环境变量


3）、添加扫描的项目，window+r打开cmd，到需要扫描的项目下执行命令

sonar-scanner.bat -Dsonar.projectKey=myproject -Dsonar.sources=. -Dsonar.host.url=http://localhost:9000 -Dsonar.login=(已创建的token)
1

说明项目扫描完成，在页面管理端就可看到项目的分析报告了
4）、如需重新扫描项目，重新执行上一步骤即可
5）、当然，每次执行那么长一条命令让人困惑，这里可以在scanner的conf目录下修改配置文件 sonar-scanner.properties

# your authentication token
sonar.login=[之前生成的token]

# must be unique in a given SonarQube instance
sonar.projectKey=[项目key]
# this is the name and version displayed in the SonarQube UI. Was mandatory prior to SonarQube 6.1.
sonar.projectName=[项目名称]
sonar.projectVersion=1.0

# Path is relative to the sonar-project.properties file. Replace "\" by "/" on Windows.
# This property is optional if sonar.modules is set. 
# Comma-separated paths to directories containing source files.
# 设置要分析的路径
sonar.sources=.

# Encoding of the source code. Default is default system encoding
sonar.sourceEncoding=UTF-8

# Set the language of the source code to analyze
# 不设置则默认分析多种语言
sonar.language = js



6）、然后到scanner的bin目录下运行sonar-scanner.bat

3、汉化

登录到系统中，在页面上找到Administration > Marketplace，在搜索框中输入chinese，会出现一个Chinese Pack，点击右侧的install按钮进行安装。
安装成功后，会提示重启 SonarQube 服务器。
只需要等提示框消失后页面就已经显示中文了。

    
   
